!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{FNuS:function(t,n,i){"use strict";i.r(n),i.d(n,"AcompanharPageModule",(function(){return E}));var o,a,s,c=i("TEn/"),u=i("tyNb"),d=i("mrSG"),l=i("fXoL"),p=i("Dp36"),m=i("fkzy"),g=i("9qa2"),h=["mapElementOrigem"],f=[{path:"",component:(o=function(){function t(r,n,i,o){e(this,t),this.api=r,this.route=n,this.navController=i,this.utils=o,this.ultimaPosicaoEntregador={}}return r(t,[{key:"ionViewWillEnter",value:function(){var e=this;this.route.paramMap.subscribe((function(t){return Object(d.b)(e,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.idCorrida=t.get("corrida"),this.idEntrega=t.get("entrega"),this.carregaMapa();case 1:case"end":return e.stop()}}),e,this)})))}))}},{key:"carregaMapa",value:function(){return Object(d.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.retornaCorrida();case 2:if((t=e.sent).data){e.next=5;break}return e.abrupt("return",void this.voltar());case 5:this.utils.mensagemAviso("Bem-vindo ao GoTele. Acompanhe aqui o andamento da sua entrega."),this.corrida=t.data,r=this.utils.retornaPosition(this.corrida.latitudeOrigem,this.corrida.longitudeOrigem),setTimeout((function(){return Object(d.b)(n,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.map=new google.maps.Map(this.mapElementOrigem.nativeElement,{styles:[{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"transit.station.bus",stylers:[{visibility:"off"}]}],center:r,disableDefaultUI:!0,zoom:14}),new google.maps.Marker({position:r,map:this.map,title:this.corrida.nomeCliente,icon:"/assets/icon/home.png"}),this.localEntrega=this.utils.retornaPosition(this.corrida.latitudeDestino,this.corrida.longitudeDestino),new google.maps.Marker({position:this.localEntrega,map:this.map,title:"Estou aqui",icon:"/assets/icon/person.png"}),this.direcaoDestinoCorrida=new google.maps.DirectionsRenderer({suppressMarkers:!0}),this.direcaoDestinoCorrida.setMap(this.map),this.carregaPosicaoEntregador();case 1:case"end":return e.stop()}}),e,this)})))}),200);case 8:case"end":return e.stop()}}),e,this)})))}},{key:"retornaCorrida",value:function(){return Object(d.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.get("publico/cliente/corrida/"+this.idCorrida+"/entrega/"+this.idEntrega);case 2:return t=e.sent,e.abrupt("return",t.data?t:(this.utils.mensagemAviso("Entrega n\xe3o est\xe1 dispon\xedvel no momento."),{}));case 4:case"end":return e.stop()}}),e,this)})))}},{key:"carregaPosicaoEntregador",value:function(){return Object(d.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,n,i,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return clearTimeout(this.timerCorridaPendente),e.prev=1,e.next=4,this.retornaCorrida();case 4:if((t=e.sent).data){e.next=7;break}return e.abrupt("return",void this.voltar());case 7:r=t.data,this.ultimaPosicaoEntregador.lat!=r.latitudeEntregador&&this.ultimaPosicaoEntregador.lng!=r.longitudeEntregador&&(n=this.utils.retornaPosition(r.latitudeEntregador,r.longitudeEntregador),this.ultimaPosicaoEntregador=n,this.marcadorEntregador?this.marcadorEntregador.setPosition(n):this.marcadorEntregador=new google.maps.Marker({position:n,map:this.map,title:r.nomeEntregador,icon:"/assets/icon/entregador.png"}),i={origin:n,destination:this.localEntrega,travelMode:"DRIVING"},(new google.maps.DirectionsService).route(i,(function(e,t){return Object(d.b)(o,void 0,void 0,regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0="OK"==t,!r.t0){r.next=4;break}return r.next=4,this.direcaoDestinoCorrida.setDirections(e);case 4:case"end":return r.stop()}}),r,this)})))}))),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:clearTimeout(this.timerCorridaPendente),this.timerCorridaPendente=setTimeout((function(){o.carregaPosicaoEntregador()}),5e3);case 15:case"end":return e.stop()}}),e,this,[[1,11]])})))}},{key:"voltar",value:function(e){window.clearTimeout(this.timerCorridaPendente),this.navController.navigateRoot(["/"])}}]),t}(),o.\u0275fac=function(e){return new(e||o)(l.Ib(p.a),l.Ib(u.a),l.Ib(c.A),l.Ib(m.a))},o.\u0275cmp=l.Cb({type:o,selectors:[["app-acompanhar"]],viewQuery:function(e,t){var r;1&e&&l.pc(h,!0),2&e&&l.gc(r=l.Ub())&&(t.mapElementOrigem=r.first)},decls:7,vars:1,consts:[["appScrollbarTheme","",1,"tela-buscar-endereco",3,"fullscreen"],[1,"botao-sair-x",3,"click"],["name","close-outline"],[1,"logo-miniatura-top"],["src","/assets/logoMiniatura.png"],[1,"map"],["mapElementOrigem",""]],template:function(e,t){1&e&&(l.Lb(0,"ion-content",0),l.Lb(1,"div",1),l.Tb("click",(function(){return t.voltar()})),l.Jb(2,"ion-icon",2),l.Kb(),l.Lb(3,"div",3),l.Jb(4,"img",4),l.Kb(),l.Jb(5,"div",5,6),l.Kb()),2&e&&l.cc("fullscreen",!0)},directives:[c.h,g.a,c.j],styles:[".map[_ngcontent-%COMP%]{height:100%;width:100%;margin-top:5px}ion-content[_ngcontent-%COMP%]{--background:#513dd9}"]}),o)}],b=((a=r((function t(){e(this,t)}))).\u0275mod=l.Gb({type:a}),a.\u0275inj=l.Fb({factory:function(e){return new(e||a)},imports:[[u.i.forChild(f)],u.i]}),a),v=i("onrN"),w=i("Bfh1"),E=((s=r((function t(){e(this,t)}))).\u0275mod=l.Gb({type:s}),s.\u0275inj=l.Fb({factory:function(e){return new(e||s)},providers:[w.a],imports:[[c.w,v.a,b]]}),s)}}])}();